<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAOS INSURGENCY TERMINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        body {
            font-family: 'VT323', monospace;
            overflow: hidden;
            background-color: #000;
            color: #0f0;
        }
        
        .grid-bg {
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .crt-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 9999;
            animation: flicker 0.15s infinite;
        }
        
        @keyframes flicker {
            0% { opacity: 0.9; }
            50% { opacity: 1; }
            100% { opacity: 0.9; }
        }

        @keyframes loginFadeOut {
            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }

        @keyframes crtFlicker {
            0% { box-shadow: 0 0 0 rgba(0, 255, 0, 0); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 0, 0.8); }
            100% { box-shadow: 0 0 0 rgba(0, 255, 0, 0); }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }
        
        .glitch {
            position: relative;
        }
        
        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 #ff00ff;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        
        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 #00ffff;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        
        @keyframes glitch-anim {
            0% { clip: rect(31px, 9999px, 94px, 0); }
            10% { clip: rect(112px, 9999px, 76px, 0); }
            20% { clip: rect(85px, 9999px, 77px, 0); }
            30% { clip: rect(27px, 9999px, 97px, 0); }
            40% { clip: rect(64px, 9999px, 98px, 0); }
            50% { clip: rect(61px, 9999px, 85px, 0); }
            60% { clip: rect(99px, 9999px, 114px, 0); }
            70% { clip: rect(34px, 9999px, 115px, 0); }
            80% { clip: rect(98px, 9999px, 129px, 0); }
            90% { clip: rect(43px, 9999px, 96px, 0); }
            100% { clip: rect(82px, 9999px, 64px, 0); }
        }
        
        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 119px, 0); }
            10% { clip: rect(79px, 9999px, 66px, 0); }
            20% { clip: rect(75px, 9999px, 99px, 0); }
            30% { clip: rect(37px, 9999px, 115px, 0); }
            40% { clip: rect(73px, 9999px, 142px, 0); }
            50% { clip: rect(62px, 9999px, 77px, 0); }
            60% { clip: rect(105px, 9999px, 58px, 0); }
            70% { clip: rect(47px, 9999px, 137px, 0); }
            80% { clip: rect(112px, 9999px, 123px, 0); }
            90% { clip: rect(53px, 9999px, 97px, 0); }
            100% { clip: rect(87px, 9999px, 71px, 0); }
        }
        
        .terminal-text {
            text-shadow: 0 0 5px #0f0;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #0f0;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #0c0;
        }
        
        .btn-glow:hover {
            box-shadow: 0 0 10px #0f0;
        }
        
        .desktop-background{
          position: fixed; inset: 0; display:flex; align-items:center; justify-content:center;
          pointer-events:none; z-index:0; /* sits behind icons */
        }

        .desktop-logo{
          width: 420px; max-width: 55vmin; opacity: .22;
          /* white outline made from multi drop-shadows so it pops on dark bg */
          filter:
            drop-shadow( 0  0   0 #fff)     /* base edge */
            drop-shadow( 1px  0 0 #fff)
            drop-shadow(-1px  0 0 #fff)
            drop-shadow( 0   1px 0 #fff)
            drop-shadow( 0  -1px 0 #fff)
            drop-shadow( 1px  1px 0 #fff)
            drop-shadow(-1px -1px 0 #fff)
            drop-shadow( 1px -1px 0 #fff)
            drop-shadow(-1px  1px 0 #fff)
            drop-shadow(0 0 18px rgba(0,255,0,.25)); /* faint green glow */
        }
        
        .icon {
            transition: all 0.3s ease-in-out;
        }
        
        .icon:hover {
            filter: drop-shadow(0 0 8px rgba(0, 255, 0, 0.8));
            transform: scale(1.05);
        }
        
        .cursor-blink {
            animation: blink 1s infinite ease-in-out;
        }
        
        @keyframes blink {
            0% { opacity: 0.2; }
            50% { opacity: 1; }
            100% { opacity: 0.2; }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .window-close {
            transition: all 0.2s ease-in-out;
        }
        
        .window-close:hover {
            filter: drop-shadow(0 0 8px rgba(255, 0, 0, 0.8));
            transform: scale(1.1);
        }

        .window {
            animation: windowOpen 0.25s ease-in-out forwards;
            opacity: 0;
            transform: scale(0.95);
        }

        @keyframes windowOpen {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .window-close-anim {
            animation: windowClose 0.25s ease-in-out forwards;
        }

        @keyframes windowClose {
            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }

        input, button {
            transition: all 0.2s ease-in-out;
        }

        input:focus {
            animation: inputPulse 1.5s infinite ease-in-out;
        }

        @keyframes inputPulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.3); }
            50% { box-shadow: 0 0 0 3px rgba(0, 255, 0, 0.3); }
            100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.3); }
        }
    </style>
</head>
<body class="grid-bg h-screen overflow-hidden">
    <div class="crt-effect"></div>
    
    <!-- Terms Agreement Screen -->
    <div id="terms-screen" class="fixed inset-0 bg-black bg-opacity-90 z-[100] flex items-center justify-center">
        <div class="bg-black border-2 border-red-500 p-6 rounded-md max-w-md w-full">
            <h2 class="text-red-500 text-2xl mb-4 text-center">WARNING</h2>
            <p class="text-green-500 mb-6">
                This Site is for Zenith Project Roleplay Purposes. Do not use this website to metagame or to cause Havoc.
            </p>
            <div class="flex justify-center gap-4">
                <button id="accept-terms" class="bg-green-900 hover:bg-green-800 text-green-500 py-2 px-4 border border-green-500">
                    I ACCEPT
                </button>
                <button id="decline-terms" class="bg-red-900 hover:bg-red-800 text-red-500 py-2 px-4 border border-red-500">
                    I DISAGREE
                </button>
            </div>
        </div>
    </div>

    <!-- Boot Screen -->
    <div id="boot-screen" class="hidden fixed inset-0 bg-black z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="mb-4">
                <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Chaos_Insurgency_logo.png" 
                     alt="Chaos Insurgency Logo" 
                     class="mx-auto w-32 h-32 animate-pulse">
            </div>
            <div class="text-green-500 text-xl mb-2">CHAOS INSURGENCY</div>
            <div class="text-green-500 mb-8">SECURE BOOT SEQUENCE INITIATED</div>
            <div class="w-64 h-1 bg-green-900 mx-auto overflow-hidden">
                <div id="boot-progress" class="h-full bg-green-500" style="width: 0%"></div>
            </div>
            <div id="boot-status" class="text-green-500 text-sm mt-2">Verifying security protocols...</div>
        </div>
    </div>
    
    <!-- Login Screen -->
    <div id="login-screen" class="hidden fixed inset-0 flex flex-col items-center justify-center z-50">
        <div class="relative mb-8">
            <div class="glitch" data-text="CHAOS INSURGENCY">
                <h1 class="text-6xl text-green-500 terminal-text animate-pulse" style="animation-duration: 2s; text-shadow: 0 0 10px #0f0, 0 0 20px #0f0; animation-iteration-count: infinite;">CHAOS INSURGENCY</h1>
            </div>
        </div>
        
        <div class="insignia mb-8">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Chaos_Insurgency_logo.png" alt="Chaos Insurgency Logo" width="150" height="150" style="filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.7)); animation: spin 5s linear infinite;">
        </div>
        
        <div class="bg-black bg-opacity-70 border border-green-500 p-6 rounded-md w-80">
            <div class="mb-4">
                <label class="block text-green-500 text-lg mb-2">Username</label>
                <input type="text" id="username" class="w-full bg-black border border-green-500 text-green-500 px-3 py-2 focus:outline-none" value="Chaos_User">
            </div>
            <div class="mb-6">
                <label class="block text-green-500 text-lg mb-2">Password</label>
                <input type="password" id="password" class="w-full bg-black border border-green-500 text-green-500 px-3 py-2 focus:outline-none" placeholder="••••••••">
            </div>
            <button id="login-btn" class="w-full bg-green-900 hover:bg-green-800 text-green-500 py-2 px-4 border border-green-500 btn-glow transition duration-300">
                LOGIN
            </button>
        </div>
    </div>
    
    <!-- Desktop -->
    <div id="desktop" class="hidden h-full w-full p-4 relative" style="z-index: 1;">
        <!-- Desktop Background Logo -->
        <div class="desktop-background">
            <img class="desktop-logo" src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Chaos_Insurgency_logo.png" alt="Chaos Insurgency Logo">
        </div>
        
        <!-- Taskbar -->
        <div class="fixed bottom-0 left-0 right-0 h-10 bg-black bg-opacity-90 border-t border-green-500 flex items-center px-2 z-30">
            <!-- Start Button -->
            <button class="h-8 w-8 bg-green-900 border border-green-500 flex items-center justify-center mr-2 hover:bg-green-800 transition-colors">
                <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Chaos_Insurgency_logo.png" alt="Start" class="w-5 h-5">
            </button>
            
            <!-- Clock -->
            <div class="ml-auto flex items-center bg-black bg-opacity-70 border border-green-500 px-3 py-1 text-green-500">
                <i data-feather="clock" class="mr-2 w-4 h-4"></i>
                <span id="clock">00:00:00</span>
            </div>
        </div>
        
        <!-- Desktop Icons -->
        <div class="absolute left-4 top-4 flex flex-col gap-6 w-32" style="bottom: 50px;">
            <!-- Chaos Insurgency Database -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="launchTerminal()">
                <div class="w-12 h-12 bg-green-900 border border-green-500 flex items-center justify-center mb-1 group-hover:bg-green-800 group-hover:border-green-300 transition-all duration-200">
                    <i data-feather="terminal" class="text-green-500 group-hover:text-green-300"></i>
                </div>
                <span class="text-green-500 text-center text-sm group-hover:text-green-300 group-hover:drop-shadow-[0_0_8px_rgba(0,255,0,0.8)] transition-all duration-200">Chaos Insurgency<br>Database</span>
            </div>
            
            <!-- Surveillance Control -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="launchCams()">
                <div class="w-12 h-12 bg-green-900 border border-green-500 flex items-center justify-center mb-1 group-hover:bg-green-800 group-hover:border-green-300 transition-all duration-200">
                    <i data-feather="video" class="text-green-500 group-hover:text-green-300"></i>
                </div>
                <span class="text-green-500 text-center text-sm group-hover:text-green-300 group-hover:drop-shadow-[0_0_8px_rgba(0,255,0,0.8)] transition-all duration-200">Security Camera System</span>
            </div>
            
            <!-- SELF DESTRUCT -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="selfDestruct()" title="Are you sure about this?">
                <div class="w-12 h-12 bg-red-900 border border-red-500 flex items-center justify-center mb-1 group-hover:bg-red-800 group-hover:border-red-300 transition-all duration-200">
                    <i data-feather="alert-octagon" class="text-red-500 group-hover:text-red-300"></i>
                </div>
                <span class="text-red-500 text-center text-sm group-hover:text-red-300 group-hover:drop-shadow-[0_0_8px_rgba(255,0,0,0.8)] transition-all duration-200">SELF DESTRUCT</span>
            </div>
            
            <!-- Recruit Chat -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="launchChat()">
                <div class="w-12 h-12 bg-green-900 border border-green-500 flex items-center justify-center mb-1 group-hover:bg-green-800 group-hover:border-green-300 transition-all duration-200">
                    <i data-feather="message-square" class="text-green-500 group-hover:text-green-300"></i>
                </div>
                <span class="text-green-500 text-center text-sm group-hover:text-green-300 group-hover:drop-shadow-[0_0_8px_rgba(0,255,0,0.8)] transition-all duration-200">Recruit Chat.exe</span>
            </div>
            
            <!-- Chaos Solitaire -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="launchSolitaire()">
                <div class="w-12 h-12 bg-green-900 border border-green-500 flex items-center justify-center mb-1 group-hover:bg-green-800 group-hover:border-green-300 transition-all duration-200">
                    <i data-feather="layers" class="text-green-500 group-hover:text-green-300"></i>
                </div>
                <span class="text-green-500 text-center text-sm group-hover:text-green-300 group-hover:drop-shadow-[0_0_8px_rgba(0,255,0,0.8)] transition-all duration-200">Chaos Solitaire</span>
            </div>
            
            <!-- DO NOT OPEN! -->
            <div class="icon group flex flex-col items-center cursor-pointer" onclick="launchVirus()">
                <div class="w-12 h-12 bg-red-900 border border-red-500 flex items-center justify-center mb-1 group-hover:bg-red-800 group-hover:border-red-300 transition-all duration-200">
                    <i data-feather="alert-octagon" class="text-red-500 group-hover:text-red-300"></i>
                </div>
                <span class="text-red-500 text-center text-sm group-hover:text-red-300 group-hover:drop-shadow-[0_0_8px_rgba(255,0,0,0.8)] transition-all duration-200">DO NOT OPEN!</span>
            </div>
        </div>
    </div>
    
    <!-- Terminal Window -->
    <div id="terminal-window" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4 window">
        <div class="relative w-full max-w-[90vw] max-h-[90vh] bg-black border border-green-500 overflow-hidden flex flex-col">
            <button onclick="closeTerminal()" class="absolute top-2 right-2 text-red-500 window-close">
                <i data-feather="x" class="w-6 h-6"></i>
            </button>
            
            <div class="p-4 h-full overflow-y-auto terminal-text">
                <pre class="text-green-500 text-lg">
   ██████╗ ██╗  ██╗ █████╗  ██████╗ ███████╗
  ██╔══██╗██║  ██║██╔══██╗██╔════╝ ██╔════╝
  ██████╔╝███████║███████║██║  ███╗█████╗  
  ██╔═══╝ ██╔══██║██╔══██║██║   ██║██╔══╝  
  ██║     ██║  ██║██║  ██║╚██████╔╝███████╗
  ╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚══════╝
   CHAOS INSURGENCY DATABASE TERMINAL v1.0
                </pre>
                
                <div id="terminal-content" class="mt-4">
                    <p class="text-green-500">> Welcome to Chaos Insurgency Database Terminal</p>
                    <p class="text-green-500">> Type HELP for available commands</p>
                    <div class="mt-4">
                        <div class="flex">
                            <span class="text-green-500">></span>
                            <input type="text" id="command-input" class="bg-black text-green-500 px-2 focus:outline-none flex-grow" autocomplete="off" placeholder="Enter command...">
                            <span class="text-green-500 cursor-blink">_</span>
                        </div>
                    </div>
                    <div id="command-output" class="mt-4"></div>
                </div>
            </div>
            <script>
                // Make personnel file window draggable
                const personnelWindow = document.getElementById('personnel-file-window');
                const personnelHeader = personnelWindow.querySelector('.drag-handle');
                makeDraggable(personnelWindow, personnelHeader);
            </script>
        </div>
    </div>
    
<!-- Sound Effects (served from /AUDIO on GitHub Pages) -->
<audio id="boot-sound"      src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/boot.mp3"            preload="auto"></audio>
<audio id="click-sound"     src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/click.mp3"           preload="auto"></audio>
<audio id="login-sound"     src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/login.mp3"           preload="auto"></audio>
<audio id="error-sound"     src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/error.mp3"           preload="auto"></audio>
<audio id="terminal-sound"  src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/terminal-loop.mp3"   preload="auto" loop></audio>
<audio id="window-open"     src="Audio/window-open.mp3"     preload="auto"></audio>
<audio id="window-close"    src="Audio/window-close.mp3"    preload="auto"></audio>
<audio id="glitch-sound"    src="Audio/glitch.mp3"          preload="auto"></audio>
<audio id="typing-sound"    src="Audio/typing.mp3"          preload="auto"></audio>
<audio id="static-sound"    src="Audio/static.mp3"          preload="auto"></audio>
<audio id="cam-switch"      src="Audio/cam-switch.mp3"      preload="auto"></audio>
<audio id="cam-hum"         src="Audio/cam-hum.mp3"         preload="auto" loop></audio>
<audio id="hum-sound"       src="Audio/ambience-hum.mp3"    preload="auto" loop></audio>
<audio id="keypress-sound"  src="Audio/keypress.mp3"        preload="auto"></audio>
<audio id="lock-sound"      src="Audio/lock.mp3"            preload="auto"></audio>
<audio id="loading-sound"   src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/loading.mp3"         preload="auto"></audio>
<audio id="loadambient-sound" src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/loadambient.mp3"   preload="auto"></audio>
<audio id="cam-switch"      src="Audio/cam-switch.mp3"      preload="auto"></audio>
<audio id="idiot-sound" src="https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/Audio/you-are-an-idiot.mp3" preload="auto"></audio>
<audio id="cam-switch" src="Audio/cam-switch.mp3" preload="auto"></audio>
<audio id="cam-hum"    src="Audio/cam-hum.mp3"    preload="auto" loop></audio>


    <script>
        // Launch functions for new shortcuts
        /* ===============================
   FNaF-Style Camera System
   =============================== */

// Camera system configuration
const CAMERA_SYSTEM = {
  cameras: [
    { id: 'CAM1', name: 'Main Entrance', src: 'images/cam1.jpg' },
    { id: 'CAM2', name: 'Hallway A', src: 'images/cam2.jpg' },
    { id: 'CAM3', name: 'Containment', src: 'images/cam3.jpg' },
    { id: 'CAM4', name: 'Storage', src: 'images/cam4.jpg' }
  ],
  staticImage: 'images/static.gif',
  switchSound: 'cam-switch',
  humSound: 'cam-hum'
};

let cameraWindow = null;
let activeCamera = null;

function launchCams() {
  if (!cameraWindow) {
    cameraWindow = createCameraWindow();
    document.body.appendChild(cameraWindow);
    feather.replace();
    
    // Initialize camera list
    const cameraList = cameraWindow.querySelector('#camera-list');
    CAMERA_SYSTEM.cameras.forEach((cam, index) => {
      const btn = document.createElement('button');
      btn.className = 'w-full p-2 text-left border border-green-700 hover:bg-green-900 text-green-400';
      btn.innerHTML = `
        <span class="font-mono">${cam.id}</span>
        <span class="text-xs opacity-80 block">${cam.name}</span>
      `;
      btn.addEventListener('click', () => switchCamera(cam.id));
      cameraList.appendChild(btn);
      
      // Set first camera as default
      if (index === 0) {
        btn.classList.add('bg-green-900');
        activeCamera = cam.id;
        switchCamera(cam.id);
      }
    });

    // Make window draggable
    const header = cameraWindow.querySelector('.drag-handle');
    makeDraggable(cameraWindow, header);
  }
  
  cameraWindow.classList.remove('hidden');
  playSound(CAMERA_SYSTEM.humSound, true);
  bringToFront(cameraWindow);
}

function closeCams() {
  if (!cameraWindow) return;
  playSound(CAMERA_SYSTEM.humSound, false);
  cameraWindow.classList.add('hidden');
}

function createCameraWindow() {
  const win = document.createElement('div');
  win.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-4/5 h-4/5 bg-black border border-green-500 z-50 window';
  win.style.maxWidth = '900px';
  win.style.maxHeight = '600px';
  
  win.innerHTML = `
    <div class="h-full flex flex-col">
      <!-- Header -->
      <div class="bg-green-900 border-b border-green-500 p-2 flex justify-between items-center drag-handle">
        <span class="text-green-500">Security Camera System</span>
        <button onclick="closeCams()" class="text-red-500 hover:text-red-300">
          <i data-feather="x" class="w-5 h-5"></i>
        </button>
      </div>
      
      <!-- Content -->
      <div class="flex flex-1 overflow-hidden">
        <!-- Camera List -->
        <div class="w-1/4 border-r border-green-500 p-2 overflow-y-auto">
          <div class="text-green-400 text-xs mb-2">CAMERA FEEDS</div>
          <div id="camera-list" class="space-y-2"></div>
        </div>
        
        <!-- Camera Feed -->
        <div class="flex-1 relative bg-black">
          <img id="camera-feed" class="w-full h-full object-contain" src="" alt="Camera Feed">
          
          <!-- Static overlay -->
          <div id="static-overlay" class="absolute inset-0 bg-cover bg-center opacity-0 pointer-events-none transition-opacity duration-100" 
               style="background-image: url('${CAMERA_SYSTEM.staticImage}')"></div>
               
          <!-- HUD -->
          <div class="absolute top-2 left-2 bg-black bg-opacity-70 border border-green-500 text-green-400 px-2 py-1 text-xs">
            CAM <span id="active-camera-label">--</span>
          </div>
        </div>
      </div>
      
      <!-- Footer -->
      <div class="bg-green-900 border-t border-green-500 p-1 text-xs text-green-400 text-center">
        Use 1-${CAMERA_SYSTEM.cameras.length} keys to switch cameras
      </div>
    </div>
  `;
  
  // Keyboard controls
  win.addEventListener('keydown', (e) => {
    const num = parseInt(e.key);
    if (num >= 1 && num <= CAMERA_SYSTEM.cameras.length) {
      switchCamera(CAMERA_SYSTEM.cameras[num-1].id);
    }
  });
  
  return win;
}

function switchCamera(cameraId) {
  const cam = CAMERA_SYSTEM.cameras.find(c => c.id === cameraId);
  if (!cam || activeCamera === cameraId) return;
  
  // Update active camera
  activeCamera = cameraId;
  
  // Update UI
  const cameraList = cameraWindow.querySelectorAll('#camera-list button');
  cameraList.forEach(btn => {
    btn.classList.remove('bg-green-900');
    if (btn.textContent.includes(cameraId)) {
      btn.classList.add('bg-green-900');
    }
  });
  
  document.getElementById('active-camera-label').textContent = cameraId;
  
  // Play switch sound and show static
  playSound(CAMERA_SYSTEM.switchSound);
  const staticOverlay = document.getElementById('static-overlay');
  staticOverlay.style.opacity = '0.4';
  
  // Switch feed after delay
  setTimeout(() => {
    const feed = document.getElementById('camera-feed');
    feed.src = cam.src + '?t=' + Date.now(); // Cache buster
    
    // Hide static
    setTimeout(() => {
      staticOverlay.style.opacity = '0';
    }, 300);
  }, 200);
}

function playSound(soundId, loop = false) {
  const audio = document.getElementById(soundId);
  if (!audio) return;
  
  audio.currentTime = 0;
  audio.loop = loop;
  audio.volume = loop ? 0.1 : 0.5;
  audio.play().catch(() => {});
}

        
        function selfDestruct() {
            window.open("https://www.youtube.com/watch?v=dQw4w9WgXcQ", "_blank");
            document.getElementById('click-sound').play();
        }
        
        function launchChat() {
            alert("Recruit Chat initialized. No agents currently online.");
            document.getElementById('click-sound').play();
        }
        
        function launchSolitaire() {
            const solitaireWindow = document.createElement('div');
            solitaireWindow.className = 'fixed bg-black border border-green-500 max-w-[90vw] max-h-[90vh] w-64 z-40 cursor-move window';
            solitaireWindow.style.top = '50%';
            solitaireWindow.style.left = '50%';
            solitaireWindow.style.transform = 'translate(-50%, -50%)';
            
            const solitaireHeader = document.createElement('div');
            solitaireHeader.className = 'bg-green-900 text-green-500 p-2 flex justify-between items-center';
            solitaireHeader.innerHTML = `
                <span>Chaos Solitaire</span>
                <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                    <i data-feather="x" class="w-4 h-4"></i>
                </button>
            `;
            
            const solitaireContent = document.createElement('div');
            solitaireContent.className = 'p-4 h-full flex items-center justify-center';
            solitaireContent.innerHTML = `
                <p class="text-green-500 text-center">ERROR: Card textures missing.<br>Contact your local anomaly for assistance.</p>
            `;
            
            solitaireWindow.appendChild(solitaireHeader);
            solitaireWindow.appendChild(solitaireContent);
            document.body.appendChild(solitaireWindow);
            feather.replace();
            document.getElementById('click-sound').play();
            
            // Make window draggable
            makeDraggable(solitaireWindow, solitaireHeader);
        }
        
        let virusSpawnSpeed = 5000; // Initial spawn speed in ms (5 seconds)
        
/* === YOU ARE AN IDIOT — drop-in replacement === */
let virusActive = false;
let virusSpawnDelay = 2000;               // starts slow, speeds up
const VIRUS_MIN_DELAY = 250;              // how fast it can get
const VIRUS_MAX_WINDOWS = 120;            // safety cap
const virusWindows = new Set();

function launchVirus() {
  if (virusActive) return;                // only start once
  virusActive = true;
  loopIdiotSound(true);

  // start with a few windows
  for (let i = 0; i < 3; i++) spawnVirusWindow();

  // self-accelerating spawner (like the classic)
  scheduleNextSpawn();
}

function scheduleNextSpawn() {
  if (!virusActive) return;
  setTimeout(() => {
    spawnVirusWindow();
    virusSpawnDelay = Math.max(VIRUS_MIN_DELAY, virusSpawnDelay * 0.9); // speed up
    scheduleNextSpawn();
  }, virusSpawnDelay);
}

function spawnVirusWindow() {
  if (virusWindows.size >= VIRUS_MAX_WINDOWS) return;

  const win = document.createElement('div');
  win.className = 'fixed bg-black border border-red-500 w-72 select-none window';
  win.style.zIndex = 9998; // stays above your app windows, under CRT overlay
  win.style.top  = Math.max(0, Math.random() * (window.innerHeight - 180)) + 'px';
  win.style.left = Math.max(0, Math.random() * (window.innerWidth  - 280)) + 'px';
  win.style.boxShadow = '0 0 12px rgba(255,0,0,.5)';

win.innerHTML = `
  <div class="drag-handle bg-red-900 text-red-500 p-2 flex justify-between items-center">
    <span class="font-bold">YOU ARE AN IDIOT!</span>
    <button class="close-btn text-red-300 hover:text-red-100">
      <i data-feather="x" class="w-4 h-4"></i>
    </button>
  </div>
  <div class="p-4 h-24 flex flex-col items-center justify-center text-center">
    <div class="text-2xl text-red-500 animate-pulse leading-tight">YOU ARE<br>AN IDIOT!</div>
  </div>
`;

  document.body.appendChild(win);
  feather.replace();
  virusWindows.add(win);

  // make draggable via your existing helper
  const header = win.querySelector('.drag-handle');
  makeDraggable(win, header);

  // bouncing movement like the original prank
  const vx = (Math.random() * 1.5 + 0.8) * (Math.random() < 0.5 ? -1 : 1);
  const vy = (Math.random() * 1.5 + 0.8) * (Math.random() < 0.5 ? -1 : 1);
  startBouncing(win, vx, vy);

  // close == it multiplies and speeds up (no inline onclick; bind properly)
  win.querySelector('.close-btn').addEventListener('click', (e) => {
    e.stopPropagation();
    win.remove();
    virusWindows.delete(win);
    virusSpawnDelay = Math.max(VIRUS_MIN_DELAY, virusSpawnDelay * 0.7); // faster
    spawnVirusWindow();
    spawnVirusWindow();
  });
}

function startBouncing(el, vx, vy) {
  let x = el.offsetLeft;
  let y = el.offsetTop;
  const tick = () => {
    if (!document.body.contains(el)) return;
    const w = el.offsetWidth, h = el.offsetHeight;

    x += vx; y += vy;

    // bounce off edges (keep a little space above the taskbar)
    if (x <= 0 || x + w >= window.innerWidth) {
      vx *= -1; x = Math.max(0, Math.min(x, window.innerWidth - w));
    }
    if (y <= 0 || y + h >= window.innerHeight - 40) {
      vy *= -1; y = Math.max(0, Math.min(y, window.innerHeight - h - 40));
    }

    el.style.left = x + 'px';
    el.style.top  = y + 'px';

    requestAnimationFrame(tick);
  };
  requestAnimationFrame(tick);
}

function loopIdiotSound(on){
  const a = document.getElementById('idiot-sound');
  if (!a) return;
  a.loop = true;
  a.volume = 0.35;
  if (on) { a.currentTime = 0; a.play().catch(()=>{}); }
  else { a.pause(); a.currentTime = 0; }
}


        
        function launchChat() {
            const chatWindow = document.createElement('div');
            chatWindow.className = 'fixed bg-black border border-green-500 max-w-[90vw] max-h-[90vh] w-80 z-40 cursor-move window';
            chatWindow.style.top = '50%';
            chatWindow.style.left = '50%';
            chatWindow.style.transform = 'translate(-50%, -50%)';
            
            const chatHeader = document.createElement('div');
            chatHeader.className = 'bg-green-900 text-green-500 p-2 flex justify-between items-center';
            chatHeader.innerHTML = `
                <span>Recruit Chat.exe</span>
                <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                    <i data-feather="x" class="w-4 h-4"></i>
                </button>
            `;
            
            const chatContent = document.createElement('div');
            chatContent.className = 'p-4 h-80 overflow-y-auto terminal-text';
            chatContent.innerHTML = `
                <p class="text-green-500">> Connecting to secure channel...</p>
                <p class="text-green-500">> Connection established.</p>
                <p class="text-green-500">> Priority channel: Site-66 operations</p>
                <p class="text-green-500">> Last messages:</p>
                <p class="text-green-500">[UNKNOWN_USER]: Did you see the size of that anomaly?</p>
                <p class="text-green-500">[UNKNOWN_USER]: I swear the vending machine ate my ID card</p>
                <p class="text-green-500">[UNKNOWN_USER]: Who took my coffee? This is an emergency!</p>
                <p class="text-green-500">[UNKNOWN_USER]: The janitor is acting sus again</p>
                <p class="text-green-500">[UNKNOWN_USER]: Found a pizza in the containment chamber</p>
                <p class="text-green-500">[UNKNOWN_USER]: Anyone else hearing screams or is it just me?</p>
                <p class="text-green-500">[UNKNOWN_USER]: BRB, gotta contain my sanity</p>
                <p class="text-green-500">[UNKNOWN_USER]: The walls are whispering memes</p>
            `;
            
            const chatInput = document.createElement('div');
            chatInput.className = 'p-2 border-t border-green-500 flex';
            chatInput.innerHTML = `
                <input type="text" id="chat-input" class="bg-black text-green-500 border border-green-500 px-2 py-1 flex-grow" placeholder="Type message...">
                <button onclick="sendChatMessage()" class="bg-green-900 hover:bg-green-800 text-green-500 px-3 py-1 border border-green-500 ml-2">SEND</button>
            `;
            
            chatWindow.appendChild(chatHeader);
            chatWindow.appendChild(chatContent);
            chatWindow.appendChild(chatInput);
            document.body.appendChild(chatWindow);
            feather.replace();
            document.getElementById('click-sound').play();
            
            // Make window draggable
            makeDraggable(chatWindow, chatHeader);
            
            // Auto-scroll to bottom
            chatContent.scrollTop = chatContent.scrollHeight;
            
            // Auto-update chat with random messages
            const funnyMessages = [
                "The coffee machine is sentient I swear",
                "Who keeps moving my chair?",
                "Found a D-class playing solitaire with SCP-682",
                "The vending machine took my money again",
                "MTF stands for 'Missing The Fun' right?",
                "Containment breach? Nah just Dave from accounting",
                "Why does the cafeteria serve green jello?",
                "I think the walls are watching me",
                "The director just walked into a wall and disappeared",
                "Found a pizza box in the incinerator",
                "Who keeps setting all the clocks to 3:33 AM?",
                "The janitor knows too much",
                "I saw a guy in a chicken suit running down hall B",
                "The water cooler is dispensing something... not water",
                "Why do all the doors open by themselves at night?"
            ];
            
            setInterval(() => {
                if (Math.random() > 0.7) {
                    const message = funnyMessages[Math.floor(Math.random() * funnyMessages.length)];
                    const newMessage = document.createElement('p');
                    newMessage.className = 'text-green-500';
                    newMessage.textContent = `[UNKNOWN_USER]: ${message}`;
                    chatContent.appendChild(newMessage);
                    chatContent.scrollTop = chatContent.scrollHeight;
                }
            }, 10000);
        }
        
        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            if (input.value.trim() !== '') {
                document.getElementById('error-sound').play();
                const chatContent = document.querySelector('.terminal-text');
                const errorMessage = document.createElement('p');
                errorMessage.className = 'text-red-500';
                errorMessage.textContent = '> ERROR: Invalid user credentials. Message not delivered.';
                chatContent.appendChild(errorMessage);
                chatContent.scrollTop = chatContent.scrollHeight;
                input.value = '';
            }
        }
        
        function makeDraggable(element, header) {
            let isDragging = false;
            let offsetX, offsetY;
            
            header.addEventListener('mousedown', (e) => {
                isDragging = true;
                offsetX = e.clientX - element.getBoundingClientRect().left;
                offsetY = e.clientY - element.getBoundingClientRect().top;
                element.style.cursor = 'grabbing';
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    let newLeft = e.clientX - offsetX;
                    let newTop = e.clientY - offsetY;
                    
                    // Keep window within viewport bounds
                    const rect = element.getBoundingClientRect();
                    const maxLeft = window.innerWidth - rect.width;
                    const maxTop = window.innerHeight - rect.height;
                    
                    newLeft = Math.max(0, Math.min(newLeft, maxLeft));
                    newTop = Math.max(0, Math.min(newTop, maxTop));
                    
                    element.style.left = newLeft + 'px';
                    element.style.top = newTop + 'px';
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                element.style.cursor = 'move';
            });
        }
        
        // Terms agreement
        document.addEventListener('DOMContentLoaded', function() {
            // Terms agreement functionality
            const acceptBtn = document.getElementById('accept-terms');
            const declineBtn = document.getElementById('decline-terms');
            
            acceptBtn.addEventListener('click', function() {
                document.getElementById('click-sound').currentTime = 0;
                document.getElementById('click-sound').volume = 0.3;
                document.getElementById('click-sound').play();
                
                // Fade out terms screen
                document.getElementById('terms-screen').style.animation = 'fadeOut 0.3s forwards';
                
                setTimeout(() => {
                    document.getElementById('terms-screen').classList.add('hidden');
                    
                    // Show boot screen
                    document.getElementById('boot-screen').classList.remove('hidden');
                    
                    // Play loading sound
                    document.getElementById('loading-sound').currentTime = 0;
                    document.getElementById('loading-sound').volume = 0.3;
                    document.getElementById('loading-sound').play();
                    
                    // Start boot sequence
                    startBootSequence();
                }, 300);
            });

            declineBtn.addEventListener('click', function() {
                document.getElementById('click-sound').currentTime = 0;
                document.getElementById('click-sound').volume = 0.3;
                document.getElementById('click-sound').play();
                
                document.getElementById('terms-screen').style.animation = 'fadeOut 0.3s forwards';
                setTimeout(() => {
                    window.location.href = 'https://www.google.com';
                }, 300);
            });
        });

        function startBootSequence() {
            const bootScreen = document.getElementById('boot-screen');
            const loginScreen = document.getElementById('login-screen');
            bootScreen.classList.remove('hidden');
            const bootProgress = document.getElementById('boot-progress');
            const bootStatus = document.getElementById('boot-status');
            
            // Play loading sound once
            const loadingSound = document.getElementById('loading-sound');
            loadingSound.currentTime = 0;
            loadingSound.volume = 0.3;
            loadingSound.play();
            
            // Set up ambient sound to play after loading sound finishes
            loadingSound.onended = function() {
                const ambientSound = document.getElementById('loadambient-sound');
                ambientSound.currentTime = 0;
                ambientSound.volume = 0.1;
                ambientSound.loop = true;
                ambientSound.play();
            };
            
            // Simulate boot process
            const bootMessages = [
                "Verifying security protocols...",
                "Initializing chaos encryption...",
                "Loading insurgent modules...",
                "Bypassing Foundation firewalls...",
                "Establishing secure connection...",
                "Finalizing initialization..."
            ];
            
            let progress = 0;
            const bootInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(bootInterval);
                    bootStatus.textContent = "Boot complete. Welcome, agent.";
                    
                    // Fade out boot screen
                    setTimeout(() => {
                        bootScreen.style.opacity = '0';
                        bootScreen.style.transition = 'opacity 0.5s ease-out';
                        
                        // Remove boot screen after fade
                        setTimeout(() => {
                            bootScreen.remove();
                            // Stop ambient sound and start hum sound
                            document.getElementById('loadambient-sound').pause();
                            document.getElementById('loadambient-sound').currentTime = 0;
                            
                            // Show login screen with animation
                            loginScreen.style.opacity = '0';
                            loginScreen.style.transform = 'translateY(20px)';
                            loginScreen.classList.remove('hidden');
                            
                            // Play boot sound when login screen appears
                            document.getElementById('boot-sound').currentTime = 0;
                            document.getElementById('boot-sound').volume = 0.3;
                            document.getElementById('boot-sound').play();
                            
                            // Start ambient sounds
                            document.getElementById('hum-sound').currentTime = 0;
                            document.getElementById('hum-sound').volume = 0.1;
                            document.getElementById('hum-sound').play();
                            
                            // Animate login screen entrance
                            setTimeout(() => {
                                loginScreen.style.transition = 'all 0.8s ease-out';
                                loginScreen.style.opacity = '1';
                                loginScreen.style.transform = 'translateY(0)';
                                
                                // Add CRT flicker effect
                                setTimeout(() => {
                                    loginScreen.style.boxShadow = '0 0 30px rgba(0, 255, 0, 0.8)';
                                    setTimeout(() => {
                                        loginScreen.style.boxShadow = 'none';
                                    }, 100);
                                }, 400);
                            }, 10);
                        }, 500);
                    }, 1000);
                }
                
                bootProgress.style.width = `${progress}%`;
                
                // Update status message every 20% progress
                if (progress % 20 < 1) {
                    const msgIndex = Math.min(Math.floor(progress / 20), bootMessages.length - 1);
                    bootStatus.textContent = bootMessages[msgIndex];
                }
            }, 300);
            updateClock();
            setInterval(updateClock, 1000);
            feather.replace();
            
            // Add static effect to login screen
            setInterval(function() {
                if (Math.random() > 0.7) {
                    document.getElementById('login-screen').style.opacity = 0.9 + Math.random() * 0.2;
                }
            }, 100);
        }
        
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString();
            document.getElementById('clock').textContent = time;
        }
        
        // Initialize login screen (hidden until boot completes)
        const loginScreen = document.getElementById('login-screen');
        loginScreen.classList.add('hidden');

        // Login functionality
        document.getElementById('login-btn').addEventListener('click', function() {
            const password = document.getElementById('password').value;
            const clickSound = document.getElementById('click-sound');
            clickSound.currentTime = 0;
            clickSound.volume = 0.3;
            clickSound.play();
            
            const username = document.getElementById('username').value;
            if (username === 'Raven' && password === 'commandknowsbest') {
                // Redirect to Raven.html
                window.location.href = "Raven.html";
                return;
            } else if (username === 'Chaos_User' && password === 'password') {
                document.getElementById('lock-sound').currentTime = 0;
                document.getElementById('lock-sound').volume = 0.3;
                document.getElementById('lock-sound').play();
                document.getElementById('login-sound').currentTime = 0;
                document.getElementById('login-sound').volume = 0.3;
                document.getElementById('login-sound').play();
                setTimeout(function() {
                    // Start login animation
                    const loginScreen = document.getElementById('login-screen');
                    loginScreen.style.animation = 'loginFadeOut 0.5s forwards';
                    
                    setTimeout(function() {
                        loginScreen.classList.add('hidden');
                        loginScreen.style.animation = '';
                        
                        // Show loading animation
                        const loading = document.createElement('div');
                        loading.id = 'loading-screen';
                        loading.className = 'fixed inset-0 flex items-center justify-center bg-black z-50';
                        loading.innerHTML = `
                            <div class="text-center">
                                <div class="w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mb-4 mx-auto"></div>
                                <p class="text-green-500 text-xl">LOADING CHAOS INSURGENCY DESKTOP...</p>
                                <p class="text-green-500 mt-2" id="loading-progress">0%</p>
                            </div>
                        `;
                        document.body.appendChild(loading);
                        
                        // Simulate loading progress
                        let progress = 0;
                        const progressInterval = setInterval(function() {
                            progress += Math.random() * 10;
                            if (progress >= 100) {
                                progress = 100;
                                clearInterval(progressInterval);
                                document.getElementById('loading-progress').textContent = `${progress}%`;
                                
                                setTimeout(function() {
                                    loading.style.animation = 'fadeOut 0.3s forwards';
                                    setTimeout(function() {
                                        loading.remove();
                                        document.getElementById('desktop').classList.remove('hidden');
                                    }, 300);
                                }, 500);
                            }
                            document.getElementById('loading-progress').textContent = `${Math.min(100, Math.floor(progress))}%`;
                        }, 100);
                    }, 500);
                }, 500);
            } else {
                setTimeout(function() {
                    document.getElementById('error-sound').play();
                    document.getElementById('password').classList.add('border-red-500');
                    
                    // Create desktop popup error
                    const errorPopup = document.createElement('div');
                    errorPopup.className = 'fixed bg-black border border-red-500 max-w-[90vw] max-h-[90vh] w-64 z-40 cursor-move window';
                    errorPopup.style.top = '50%';
                    errorPopup.style.left = '50%';
                    errorPopup.style.transform = 'translate(-50%, -50%)';
                    
                    const popupHeader = document.createElement('div');
                    popupHeader.className = 'bg-red-900 text-red-500 p-2 flex justify-between items-center';
                    popupHeader.innerHTML = `
                        <span>ACCESS DENIED</span>
                        <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                            <i data-feather="x" class="w-4 h-4"></i>
                        </button>
                    `;
                    
                    const popupContent = document.createElement('div');
                    popupContent.className = 'p-4 h-full flex items-center justify-center';
                    popupContent.innerHTML = `
                        <p class="text-red-500 text-center">INVALID CREDENTIALS<br>ACCESS DENIED</p>
                    `;
                    
                    errorPopup.appendChild(popupHeader);
                    errorPopup.appendChild(popupContent);
                    document.body.appendChild(errorPopup);
                    feather.replace();
                    
                    // Make window draggable
                    makeDraggable(errorPopup, popupHeader);
                    
                    setTimeout(function() {
                        document.getElementById('password').classList.remove('border-red-500');
                    }, 1000);
                }, 500);
            }
        });
        
        // Terminal functions
        function launchTerminal() {
            document.getElementById('terminal-window').classList.remove('hidden');
            document.getElementById('terminal-sound').currentTime = 0;
            document.getElementById('terminal-sound').volume = 0.2;
            document.getElementById('terminal-sound').play();
            document.getElementById('static-sound').currentTime = 0;
            document.getElementById('static-sound').volume = 0.3;
            document.getElementById('static-sound').play();
            
            // Focus on command input immediately
            setTimeout(() => {
                document.getElementById('command-input').focus();
            }, 100);
        }
        
        function closeTerminal() {
            const terminal = document.getElementById('terminal-window');
            document.getElementById('static-sound').pause();
            document.getElementById('static-sound').currentTime = 0;
            terminal.classList.add('window-close-anim');
            setTimeout(() => {
                terminal.classList.add('hidden');
                terminal.classList.remove('window-close-anim');
                document.getElementById('terminal-sound').pause();
                document.getElementById('terminal-sound').currentTime = 0;
            }, 250);
        }
        
        
        // Terminal commands
        const commands = {
            'HELP': 'Available commands: RECRUIT_LIST, SABOTAGE_PROTOCOL, FOUNDATION_SURVEILLANCE, PERSONNEL_FILES, DOWNLOAD [filename], CLEAR',
            'RECRUIT_LIST': 'Agent List:\n- Agent "Sigma"\n- Agent "Rook"\n- Agent "Viper"\n- Agent "Spectre"\n- Agent "Mirage"\n\nStatus: Active',
            'SABOTAGE_PROTOCOL': 'Current Operations:\n- Site-19: Infiltration in progress\n- Area-12: Surveillance active\n- Site-64: Neutralized\n\nNext Target: Site-76',
            'FOUNDATION_SURVEILLANCE': 'SCP Foundation Activity:\n- SCP-173: Contained\n- SCP-682: Breach attempt detected\n- SCP-106: Active\n- SCP-049: Research ongoing\n\nMTF Movements: Epsilon-11 en route to Site-19',
            'PERSONNEL_FILES': 'Available Personnel Files:\n- Mufflin Doe  (MufflinDoe.txt)',
            'CLEAR': ''
        };

        const personnelFiles = {
            'mufflindoe.txt': {
                main: 'https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/mufflindoe.txt',
                fallbacks: [
                    'https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/MufflinDoe.txt',
                    'https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/files/mufflindoe.txt',
                    'https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/files/MufflinDoe.txt'
                ]
            }
        };
        
        document.getElementById('command-input').addEventListener('keydown', function(e) {
            if (e.key !== 'Enter') {
                document.getElementById('typing-sound').currentTime = 0;
                document.getElementById('typing-sound').volume = 0.2;
                document.getElementById('typing-sound').play();
            }
            if (e.key === 'Enter') {
                const clickSound = document.getElementById('click-sound');
                clickSound.currentTime = 0;
                clickSound.play();
                
                const input = this.value;
                const upperInput = input.toUpperCase();
                const output = document.getElementById('command-output');
                
                // Handle download command (case-insensitive)
                if (upperInput.startsWith('DOWNLOAD ')) {
                    const filename = input.substring(9).trim().toLowerCase();
                    output.innerHTML += `<p class="text-green-500">> ${input}</p>`;
                    
                    if (personnelFiles.hasOwnProperty(filename)) {
                        output.innerHTML += `<p class="text-green-500">Downloading ${filename}...</p>`;
                        downloadFile(filename, personnelFiles[filename]);
                    } else {
                        output.innerHTML += `<p class="text-red-500">ERROR: File not found. Use PERSONNEL_FILES to see available files.</p>`;
                    }
                }
                // Handle regular commands (case-insensitive)
                else if (commands.hasOwnProperty(upperInput)) {
                    if (upperInput === 'CLEAR') {
                        output.innerHTML = '';
                    } else {
                        output.innerHTML += `<p class="text-green-500">> ${input}</p>`;
                        output.innerHTML += `<p class="text-green-500">${commands[upperInput]}</p>`;
                    }
                } else {
                    output.innerHTML += `<p class="text-green-500">> ${input}</p>`;
                    output.innerHTML += `<p class="text-red-500">ERROR: Unknown command. Type HELP for available commands.</p>`;
                }
                
                this.value = '';
                output.scrollTop = output.scrollHeight;
            }
        });

        function downloadFile(filename, fileData) {
            // Create file icon on desktop
            const desktop = document.getElementById('desktop');
            const fileIcon = document.createElement('div');
            fileIcon.className = 'icon group flex flex-col items-center cursor-pointer absolute';
            fileIcon.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            fileIcon.style.top = Math.random() * (window.innerHeight - 150) + 'px';
            fileIcon.innerHTML = `
                <div class="w-12 h-12 bg-blue-900 border border-blue-500 flex items-center justify-center mb-1 group-hover:bg-blue-800 group-hover:border-blue-300 transition-all duration-200">
                    <i data-feather="file-text" class="text-blue-500 group-hover:text-blue-300"></i>
                </div>
                <span class="text-blue-500 text-center text-sm group极hover:text-blue-300 group-hover:drop-shadow-[0_0_8px_rgba(0,0,255,0.8)] transition-all duration-200">${filename}</span>
            `;
            
            fileIcon.onclick = function() {
                fetch('https://raw.githubusercontent.com/CybRepr/ChaosPC.github.io/main/mufflindoe.txt')
                    .then(response => response.text())
                    .then(content => {
                        displayFileContent(content);
                    })
                    .catch(error => {
                        const errorWindow = document.createElement('div');
                        errorWindow.className = 'fixed bg-black border border-red-500 max-w-[90vw] max-h-[90vh] w-96 z-40 cursor-move window';
                        errorWindow.style.top = '50%';
                        errorWindow.style.left = '50%';
                        errorWindow.style.transform = 'translate(-50%, -50%)';
                        
                        errorWindow.innerHTML = `
                            <div class="bg-red-900 text-red-500 p-2 flex justify-between items-center">
                                <span>ERROR</span>
                                <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                                    <i data-feather="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div class="p-4 h-64 flex items-center justify-center">
                                <p class="text-red-500">Failed to load file content.</p>
                            </div>
                        `;
                        
                        document.body.appendChild(errorWindow);
                        feather.replace();
                    });
            };
            
            desktop.appendChild(fileIcon);
            feather.replace();
            
            const output = document.getElementById('command-output');
            output.innerHTML += `<p class="text-green-500">Download complete. File icon added to desktop.</p>`;
            output.scrollTop = output.scrollHeight;
        }

        function fetchFileContent(url) {
            // Create loading window
            const loadingWindow = document.createElement('div');
            loadingWindow.className = 'fixed bg-black border border-green-500 max-w-[90vw] max-h-[90vh] w-96 z-40 cursor-move window';
            loadingWindow.style.top = '50%';
            loadingWindow.style.left = '50%';
            loadingWindow.style.transform = 'translate(-50%, -50%)';
            
            loadingWindow.innerHTML = `
                <div class="bg-green-900 text-green-500 p-2 flex justify-between items-center">
                    <span>Loading File...</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                        <i data-feather="x" class="w-4 h-4"></i>
                    </button>
                </div>
                <div class="p-4 h-64 flex items-center justify-center">
                    <p class="text-green-500">Connecting to secure server...</p>
                </div>
            `;
            
            document.body.appendChild(loadingWindow);
            feather.replace();
            
            // Fetch content from Pastebin
            fetch(url)
                .then(response => response.text())
                .then(content => {
                    loadingWindow.remove();
                    displayFileContent(content);
                })
                .catch(error => {
                    loadingWindow.remove();
                    const errorWindow = document.createElement('div');
                    errorWindow.className = 'fixed bg-black border border-red-500 max-w-[90vw] max-h-[90vh] w-96 z-40 cursor-move window';
                    errorWindow.style.top = '50%';
                    errorWindow.style.left = '50%';
                    errorWindow.style.transform = 'translate(-50%, -50%)';
                    
                    errorWindow.innerHTML = `
                        <div class="bg-red-900 text-red-500 p-2 flex justify-between items-center">
                            <span>ERROR</span>
                            <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                                <i data-feather="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="p-4 h-64 flex items-center justify-center">
                            <p class="text-red-500">Failed to load file content.</p>
                        </div>
                    `;
                    
                    document.body.appendChild(errorWindow);
                    feather.replace();
                });
        }

        function displayFileContent(content) {
            // Parse BBCode and convert to HTML
            let htmlContent = content
                .replace(/\[b\](.*?)\[\/b\]/g, '<strong>$1</strong>')
                .replace(/\[i\](.*?)\[\/i\]/g, '<em>$1</em>')
                .replace(/\[u\](.*?)\[\/u\]/g, '<u>$1</u>')
                .replace(/\[color=(.*?)\](.*?)\[\/color\]/g, '<span style="color: $1">$2</span>')
                .replace(/\[quote\](.*?)\[\/quote\]/gs, '<div class="quote-block">$1</div>')
                .replace(/\n/g, '<br>');
            
            // Create file content window
            const fileWindow = document.createElement('div');
            fileWindow.className = 'fixed bg-black border border-green-500 max-w-[90vw] max-h-[90vh] w-3/4 z-40 cursor-move window';
            fileWindow.style.top = '50%';
            fileWindow.style.left = '50%';
            fileWindow.style.transform = 'translate(-50%, -50%)';
            
            fileWindow.innerHTML = `
                <div class="bg-green-900 text-green-500 p-2 flex justify-between items-center drag-handle">
                    <span>Personnel File</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-red-500 window-close">
                        <i data-feather="x" class="w-4 h-4"></i>
                    </button>
                </div>
                <div class="p-4 h-96 overflow-y-auto terminal-text" style="color: #0f0; text-shadow: 0 0 5px #0f0;">
                    ${htmlContent}
                </div>
            `;
            
            document.body.appendChild(fileWindow);
            feather.replace();
            
            // Make window draggable
            const header = fileWindow.querySelector('.drag-handle');
            makeDraggable(fileWindow, header);
            
            // Add CSS for quote blocks if not already exists
            if (!document.getElementById('quote-style')) {
                const style = document.createElement('style');
                style.id = 'quote-style';
                style.textContent = `
                    .quote-block {
                        border-left: 3px solid #0f0;
                        padding-left: 10px;
                        margin: 10px 0;
                        background: rgba(0, 255, 0, 0.1);
                        padding: 8px;
                    }
                `;
                document.head.appendChild(style);
            }
        }
    </script>
</body>
</html>
